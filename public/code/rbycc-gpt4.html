<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>å¹³å‡åå­¦ä¹ å°æµ‹éªŒ</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    background: #282c34;
    color: #eee;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    user-select: none;
  }
  .container {
    text-align: center;
    width: 320px;
  }
  .hiragana {
    font-size: 6rem;
    margin-bottom: 1rem;
    opacity: 1;
    transition: opacity 0.5s ease;
  }
  .fade-out {
    opacity: 0;
  }
  .options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
  button.option {
    background: #3a3f51;
    border: none;
    padding: 1rem;
    border-radius: 8px;
    font-size: 1.25rem;
    color: #eee;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  button.option:hover {
    background: #5a5f7d;
  }
  .feedback {
    font-size: 1.25rem;
    height: 1.5rem;
    margin-bottom: 0.5rem;
    min-height: 1.5rem;
    color: #88cc88;
  }
  .feedback.incorrect {
    color: #cc6666;
  }
</style>
</head>
<body>
  <div class="container" role="main">
    <div id="hiragana" class="hiragana" aria-live="polite">ã‚</div>
    <div class="options" role="list">
      <!-- Buttons will be inserted here -->
    </div>
    <div id="feedback" class="feedback" aria-live="assertive"></div>
  </div>

<script>
  // å¹³å‡åè¡¨ï¼šå­—ç¬¦ + æ­£ç¡®ç½—é©¬éŸ³
  const hiraganaList = [
    { char: 'ã‚', romaji: 'a' },
    { char: 'ã„', romaji: 'i' },
    { char: 'ã†', romaji: 'u' },
    { char: 'ãˆ', romaji: 'e' },
    { char: 'ãŠ', romaji: 'o' },
    { char: 'ã‹', romaji: 'ka' },
    { char: 'ã', romaji: 'ki' },
    { char: 'ã', romaji: 'ku' },
    { char: 'ã‘', romaji: 'ke' },
    { char: 'ã“', romaji: 'ko' }
    // ä½ å¯ä»¥æ‰©å±•æ›´å¤šå¹³å‡å
  ];

  const optionsCount = 4;
  let currentIndex = 0;

  const hiraganaDiv = document.getElementById('hiragana');
  const optionsDiv = document.querySelector('.options');
  const feedbackDiv = document.getElementById('feedback');

  // éšæœºæ‰“ä¹±æ•°ç»„
  function shuffleArray(arr) {
    return arr
      .map(value => ({ value, sort: Math.random() }))
      .sort((a, b) => a.sort - b.sort)
      .map(({ value }) => value);
  }

  // ç”Ÿæˆé€‰é¡¹ï¼ˆåŒ…å«æ­£ç¡®ç­”æ¡ˆå’Œéšæœºé”™è¯¯ç­”æ¡ˆï¼‰
  function generateOptions(correctRomaji) {
    // é™¤å»æ­£ç¡®ç­”æ¡ˆï¼Œé€‰ä¸‰ä¸ªéšæœºé”™è¯¯é€‰é¡¹
    let wrongOptions = hiraganaList
      .filter(h => h.romaji !== correctRomaji)
      .map(h => h.romaji);

    wrongOptions = shuffleArray(wrongOptions).slice(0, optionsCount - 1);

    // æŠŠæ­£ç¡®ç­”æ¡ˆåŠ è¿›å»ï¼Œæ‰“ä¹±é¡ºåº
    const allOptions = shuffleArray([correctRomaji, ...wrongOptions]);

    return allOptions;
  }

  // æ˜¾ç¤ºå½“å‰å­—ç¬¦å’Œé€‰é¡¹
  function showCurrent() {
    feedbackDiv.textContent = '';
    const current = hiraganaList[currentIndex];
    
    // åŠ¨ç”»æ·¡å‡º
    hiraganaDiv.classList.add('fade-out');
    setTimeout(() => {
      hiraganaDiv.textContent = current.char;
      hiraganaDiv.classList.remove('fade-out');
    }, 500);

    // æ¸…ç©ºé€‰é¡¹
    optionsDiv.innerHTML = '';

    // ç”Ÿæˆé€‰é¡¹æŒ‰é’®
    const opts = generateOptions(current.romaji);
    opts.forEach(opt => {
      const btn = document.createElement('button');
      btn.className = 'option';
      btn.textContent = opt;
      btn.setAttribute('type', 'button');
      btn.addEventListener('click', () => {
        checkAnswer(opt);
      });
      optionsDiv.appendChild(btn);
    });
  }

  // æ£€æŸ¥ç­”æ¡ˆï¼Œæ˜¾ç¤ºåé¦ˆå¹¶è·³è½¬ä¸‹ä¸€é¢˜
  function checkAnswer(selected) {
    const correct = hiraganaList[currentIndex].romaji;
    if (selected === correct) {
      feedbackDiv.textContent = 'å›ç­”æ­£ç¡® ğŸ‰';
      feedbackDiv.classList.remove('incorrect');
    } else {
      feedbackDiv.textContent = `é”™è¯¯ï¼Œæ­£ç¡®è¯»éŸ³æ˜¯ "${correct}"`;
      feedbackDiv.classList.add('incorrect');
    }
    // ç¦ç”¨æŒ‰é’®é˜²æ­¢å¤šæ¬¡ç‚¹å‡»
    Array.from(optionsDiv.children).forEach(btn => btn.disabled = true);

    // ç­‰1.5ç§’åˆ‡æ¢ä¸‹ä¸€é¢˜
    setTimeout(() => {
      currentIndex = (currentIndex + 1) % hiraganaList.length;
      showCurrent();
    }, 1500);
  }

  // åˆå§‹åŒ–
  showCurrent();

</script>
</body>
</html>
